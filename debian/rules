#!/usr/bin/make -f
# -*- makefile -*-
# vi: ts=4 sw=4 noet
#
# debian/rules file that uses debhelper
# Based on an autogenerated debhelper sample
#

# Uncomment this to turn on verbose mode
#export DH_VERBOSE=1

DEB_BUILD_ARCH_CPU ?= $(shell dpkg-architecture -qDEB_BUILD_ARCH_CPU)

EXTRA_CMAKE_FLAGS =

ifeq ($(DH_VERBOSE),1)
	EXTRA_CMAKE_FLAGS += -DCMAKE_VERBOSE_MAKEFILE=ON
endif

%:
	dh $@ --buildsystem=cmake --builddirectory=builddir --parallel

override_dh_auto_configure:
	mkdir -p builddir
	cd builddir && cmake .. \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_C_FLAGS="$(CFLAGS)" \
		-DCMAKE_LD_FLAGS="-Wl,-z,defs" \
		-DCMAKE_CXX_FLAGS="$(CXXFLAGS)" \
		-DENABLE_LIRC=ON \
		-DCMAKE_SKIP_RPATH=ON \
		-DENABLE_WX=ON \
		$(EXTRA_CMAKE_FLAGS) 
